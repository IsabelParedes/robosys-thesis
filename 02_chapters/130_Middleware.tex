\chapter{Middleware Implementation}

    \ac{DDS} is a publish-subscribe communication standard defined by \ac{OMG}. \ac{DDS} uses \ac{IDL} for defining and serializing messages~\cite{rosondds}. In contrast to \ac{ROS} 1, which requires a \ac{ROS} master in order for nodes to discover and communicate with each other, \ac{ROS} 2 discovery system is handled by \ac{DDS} and each of the \ac{DDS} vendors provides different options for customizing the communication protocol.

\section{DDS Middleware}

    ROS supported middleware implementations

    \subsection{FastDDS}

    default

    \subsection{Eclypse}

    \subsection{Gurum}

    


\section{Custom Middleware}

    Why it needs to be replaced

    \subsection{Email}

    \subsection{Zenoh}

    Minimal implementation (minimal set of functions)

    
\section{Substituting ROS 2 Middleware}

    At run time

    At build time

\section{Custom Middleware Design}

    Design of middleware packages (tree diagram or something)

    \subsection{\textsf{wasm\_cpp}}


    \begin{figure}[htbp]
        \centering
        \begin{tikzpicture}%[show background grid]
            \begin{abstractclass}[text width=5cm]{Participant}{0,0}
                \attribute{- name : String}
                \attribute{- role : String}
                \attribute{- gid  : String}

                \operation{- is\_valid\_name()}
                \operation{- is\_valid\_role()}
                \operation{- registration()}
                \operation{- deregistration()}
            \end{abstractclass}

            \begin{class}[text width=5cm]{Publisher}{-5,-6}
                \inherit{Participant}
                \attribute{- name = topic\_name}
                \attribute{- role = publisher}
                \operation{+ publish(message : String)}
            \end{class}

            \begin{class}[text width=5cm]{Subscriber}{5,-6}
                \inherit{Participant}
                \attribute{- name = topic\_name}
                \attribute{- role = subscriber}
                \operation{+ get\_message() : String}
            \end{class}

            \begin{class}[text width=6.5cm]{ServiceServer}{-4,-11}
                \inherit{Participant}
                \attribute{- name = service\_name}
                \attribute{- role = service\_server}
                \operation{+ take\_request() : String}
                \operation{+ send\_response(response : String)}
            \end{class}

            \composition{ServiceServer}{}{}{Publisher}
            \composition{ServiceServer}{}{}{Subscriber}

            \begin{class}[text width=6.5cm]{ServiceClient}{4,-11}
                \inherit{Participant}
                \attribute{- name = service\_name}
                \attribute{- role = service\_client}
                \operation{+ send\_request(request : String)}
                \operation{+ take\_response() : String}
                \operation{+ is\_service\_available() : Bool}
            \end{class}

            \composition{ServiceClient}{}{}{Publisher}
            \composition{ServiceClient}{}{}{Subscriber}

        \end{tikzpicture}
        \caption{A class diagram}
    \end{figure}
    
